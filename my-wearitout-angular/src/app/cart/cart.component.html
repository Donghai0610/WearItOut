<app-header></app-header>
<div class="cart-container">
  <div class="cart-header">
    <h2>ğŸ›’ Giá» hÃ ng cá»§a báº¡n</h2>
    <p *ngIf="cartItems.length > 0">Báº¡n cÃ³ {{ cartItems.length }} sáº£n pháº©m trong giá» hÃ ng</p>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Äang táº£i giá» hÃ ng...</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="error-message">
    {{ error }}
    <button (click)="loadCart()" class="btn-retry">ğŸ”„ Thá»­ láº¡i</button>
  </div>

  <!-- Success Message -->
  <div *ngIf="successMessage" class="success-message">
    âœ… {{ successMessage }}
  </div>

  <!-- Empty Cart -->
  <div *ngIf="!isLoading && !error && cartItems.length === 0" class="empty-cart">
    <div class="empty-icon">ğŸ›’</div>
    <h3>Giá» hÃ ng trá»‘ng</h3>
    <p>HÃ£y thÃªm má»™t sá»‘ sáº£n pháº©m vÃ o giá» hÃ ng Ä‘á»ƒ báº¯t Ä‘áº§u mua sáº¯m!</p>
    <a href="/products" class="btn-shop-now">ğŸ›ï¸ Mua sáº¯m ngay</a>
  </div>

  <!-- Cart Items -->
  <div *ngIf="!isLoading && !error && cartItems.length > 0" class="cart-content">
    <div class="cart-items">
      <div *ngFor="let item of cartItems; trackBy: trackByProductId" class="cart-item">
        <div class="item-image">
          <img 
            [src]="item.imageUrl" 
            [alt]="item.productName"
            onerror="this.src='https://via.placeholder.com/100x100?text=No+Image'"
          >
        </div>
        
        <div class="item-details">
          <h4 class="item-name">{{ item.productName }}</h4>
          <p class="item-price">{{ formatPrice(item.price) }}</p>
          <div *ngIf="item.stockQuantity" class="stock-info">
            <p class="item-stock" [ngClass]="getStockStatusClass(item)">
              ğŸ“¦ {{ getStockStatus(item) }}
            </p>
            <p *ngIf="!isStockAvailable(item)" class="stock-warning">
              âš ï¸ KhÃ´ng thá»ƒ thÃªm! ÄÃ£ Ä‘áº¡t giá»›i háº¡n kho.
            </p>
          </div>
        </div>
        
        <div class="item-quantity">
          <button 
            (click)="decreaseQuantity(item.productId)"
            [disabled]="item.quantity <= 1"
            class="btn-quantity"
          >-</button>
          <input 
            type="number" 
            [value]="item.quantity"
            (input)="onQuantityChange(item.productId, $event)"
            min="1"
            [max]="getMaxQuantity(item)"
            class="quantity-input"
            [title]="'Tá»‘i Ä‘a: ' + getMaxQuantity(item)"
          >
          <button 
            (click)="increaseQuantity(item.productId)"
            [disabled]="!isStockAvailable(item)"
            class="btn-quantity"
            [title]="!isStockAvailable(item) ? 'ÄÃ£ Ä‘áº¡t giá»›i háº¡n kho' : 'TÄƒng sá»‘ lÆ°á»£ng'"
          >+</button>
        </div>
        
        <div class="item-total">
          <p class="total-price">{{ formatPrice(item.price * item.quantity) }}</p>
        </div>
        
        <div class="item-actions">
          <button 
            (click)="removeItem(item.productId)"
            class="btn-remove"
            title="XÃ³a sáº£n pháº©m"
          >ğŸ—‘ï¸</button>
        </div>
      </div>
    </div>

    <!-- Cart Summary -->
    <div class="cart-summary">
      <div class="summary-section">
        <h3>ğŸ“‹ TÃ³m táº¯t Ä‘Æ¡n hÃ ng</h3>
        
        <div class="summary-row">
          <span>Sá»‘ lÆ°á»£ng sáº£n pháº©m:</span>
          <span>{{ cartItems.length }} sáº£n pháº©m</span>
        </div>
        
        <div class="summary-row">
          <span>Tá»•ng sá»‘ lÆ°á»£ng:</span>
          <span>{{ getTotalQuantity() }} mÃ³n</span>
        </div>
        
        <div class="summary-row subtotal">
          <span>Táº¡m tÃ­nh:</span>
          <span>{{ formatPrice(totalPrice) }}</span>
        </div>
        
        <div class="summary-row shipping">
          <span>PhÃ­ váº­n chuyá»ƒn:</span>
          <span>Miá»…n phÃ­</span>
        </div>
        
        <div class="summary-row total">
          <span>Tá»•ng cá»™ng:</span>
          <span>{{ formatPrice(totalPrice) }}</span>
        </div>
        
        <div class="cart-actions">
          <button class="btn-checkout">ğŸ’³ Tiáº¿n hÃ nh thanh toÃ¡n</button>
          <button (click)="clearCart()" class="btn-clear">ğŸ—‘ï¸ XÃ³a toÃ n bá»™ giá» hÃ ng</button>
        </div>
      </div>
    </div>
  </div>
</div>
<app-footer></app-footer>