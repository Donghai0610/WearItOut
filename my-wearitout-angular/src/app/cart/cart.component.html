<div class="cart-container">
  <div class="cart-header">
    <h2>üõí Gi·ªè h√†ng c·ªßa b·∫°n</h2>
    <p *ngIf="cartItems.length > 0">B·∫°n c√≥ {{ cartItems.length }} s·∫£n ph·∫©m trong gi·ªè h√†ng</p>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>ƒêang t·∫£i gi·ªè h√†ng...</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="error-message">
    {{ error }}
    <button (click)="loadCart()" class="btn-retry">üîÑ Th·ª≠ l·∫°i</button>
  </div>

  <!-- Empty Cart -->
  <div *ngIf="!isLoading && !error && cartItems.length === 0" class="empty-cart">
    <div class="empty-icon">üõí</div>
    <h3>Gi·ªè h√†ng tr·ªëng</h3>
    <p>H√£y th√™m m·ªôt s·ªë s·∫£n ph·∫©m v√†o gi·ªè h√†ng ƒë·ªÉ b·∫Øt ƒë·∫ßu mua s·∫Øm!</p>
    <a href="/products" class="btn-shop-now">üõçÔ∏è Mua s·∫Øm ngay</a>
  </div>

  <!-- Business Logic Info -->
  <div *ngIf="!isLoading && !error && cartItems.length > 0" class="business-logic-info">
    <div class="info-card">
      <h4>‚ÑπÔ∏è L∆∞u √Ω v·ªÅ t·ªìn kho</h4>
      <p>‚Ä¢ <strong>Kho:</strong> S·ªë l∆∞·ª£ng th·ª±c t·∫ø c√≥ s·∫µn</p>
      <p>‚Ä¢ <strong>Trong gi·ªè:</strong> S·ªë l∆∞·ª£ng b·∫°n ƒë√£ ch·ªçn</p>
      <p>‚Ä¢ S·∫£n ph·∫©m ch·ªâ ƒë∆∞·ª£c tr·ª´ kho khi <strong>ƒë·∫∑t h√†ng th√†nh c√¥ng</strong></p>
      <p>‚Ä¢ N·∫øu h·∫øt h√†ng, ƒë∆°n h√†ng s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω theo th·ª© t·ª±</p>
    </div>
  </div>

  <!-- Cart Items -->
  <div *ngIf="!isLoading && !error && cartItems.length > 0" class="cart-content">
    <div class="cart-items">
      <div *ngFor="let item of cartItems; trackBy: trackByProductId" class="cart-item">
        <div class="item-image">
          <img 
            [src]="item.imageUrl" 
            [alt]="item.productName"
            onerror="this.src='https://via.placeholder.com/100x100?text=No+Image'"
          >
        </div>
        
        <div class="item-details">
          <h4 class="item-name">{{ item.productName }}</h4>
          <p class="item-price">{{ formatPrice(item.price) }}</p>
          <div *ngIf="item.stockQuantity" class="stock-info">
            <p class="item-stock" [ngClass]="getStockStatusClass(item)">
              üì¶ {{ getStockStatus(item) }}
            </p>
            <p class="stock-detail" title="{{ getDetailedStockInfo(item) }}">
              üõí Trong gi·ªè: {{ item.quantity }} / {{ item.stockQuantity }}
            </p>
            <p class="business-info" [ngClass]="{'warning': !isStockAvailable(item), 'success': getRemainingAddable(item) > 2}">
              {{ getStockBusinessInfo(item) }}
            </p>
          </div>
        </div>
        
        <div class="item-quantity">
          <button 
            (click)="decreaseQuantity(item.productId)"
            [disabled]="item.quantity <= 1"
            class="btn-quantity"
          >-</button>
          <input 
            type="number" 
            [value]="item.quantity"
            (input)="onQuantityChange(item.productId, $event)"
            min="1"
            [max]="getMaxQuantity(item)"
            class="quantity-input"
            [title]="'T·ªëi ƒëa: ' + getMaxQuantity(item)"
          >
          <button 
            (click)="increaseQuantity(item.productId)"
            class="btn-quantity"
            [ngClass]="{'warning-btn': hasStockWarning(item)}"
            [title]="hasStockWarning(item) ? 'V∆∞·ª£t qu√° t·ªìn kho - ƒë∆°n h√†ng s·∫Ω x·ª≠ l√Ω theo th·ª© t·ª±' : 'TƒÉng s·ªë l∆∞·ª£ng'"
          >+</button>
        </div>
        
        <div class="item-total">
          <p class="total-price">{{ formatPrice(item.price * item.quantity) }}</p>
        </div>
        
        <div class="item-actions">
          <button 
            (click)="removeItem(item.productId)"
            class="btn-remove"
            title="X√≥a s·∫£n ph·∫©m"
          >üóëÔ∏è</button>
        </div>
      </div>
    </div>

    <!-- Cart Summary -->
    <div class="cart-summary">
      <div class="summary-section">
        <h3>üìã T√≥m t·∫Øt ƒë∆°n h√†ng</h3>
        
        <div class="summary-row">
          <span>S·ªë l∆∞·ª£ng s·∫£n ph·∫©m:</span>
          <span>{{ cartItems.length }} s·∫£n ph·∫©m</span>
        </div>
        
        <div class="summary-row">
          <span>T·ªïng s·ªë l∆∞·ª£ng:</span>
          <span>{{ getTotalQuantity() }} m√≥n</span>
        </div>
        
        <div class="summary-row subtotal">
          <span>T·∫°m t√≠nh:</span>
          <span>{{ formatPrice(totalPrice) }}</span>
        </div>
        
        <div class="summary-row shipping">
          <span>Ph√≠ v·∫≠n chuy·ªÉn:</span>
          <span>Mi·ªÖn ph√≠</span>
        </div>
        
        <div class="summary-row total">
          <span>T·ªïng c·ªông:</span>
          <span>{{ formatPrice(totalPrice) }}</span>
        </div>
        
        <div class="cart-actions">
          <button class="btn-checkout">üí≥ Ti·∫øn h√†nh thanh to√°n</button>
          <button (click)="clearCart()" class="btn-clear">üóëÔ∏è X√≥a to√†n b·ªô gi·ªè h√†ng</button>
        </div>
      </div>
    </div>
  </div>
</div>